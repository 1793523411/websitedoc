# 群聊

::: warning 说明
这里收集了一些群聊的面试题！！！
:::

## video 标签在移动端不兼容

::: tip Q
问个问题，video 标签在移动端不兼容,有没有成熟的解决办法,特别是安卓，各大浏览器或者微信 qq 内核全部改造了 video,视频不是不能自动播放，就是层级过高，要不就是不能控制
:::

微信可以。。,查下 api 吧,xweb 内核 安卓,可以，得用 weixinsdk 啊

滴滴官网用的视频背景，移动端采用的是 16ms 替换一张 img 图片，pc 采用 video

video.js

## H5 白屏

::: tip Q
面试题： H5 页面，发布了外网，打开以后都是白屏，你会怎么做，有可能只有他手机是白屏
:::

这个问题老经典了,从整个链路上来找问题,没有标准答案,面试官问这个问题是想看你思考问题的思路,怎么追踪并想办法解决的,一般就从网络和浏览器来考虑

既然是 h5 的话 肯定还要考虑系统的影响,之前我们项目 ios 全部白屏 安卓全部正常,我上次说的一个方法是开瀑布图,

先看自己能不能复现啊,不能复现就去拉用户日志,按照日志查关键节点,猜测会出问题的地方,本地打断点模拟问题情况,一般来说基建做的好 白屏这种大问题,还是很好查的,先看资源拿到没有,没有拿到就从浏览器排查到服务器，有时候还得排查到 cdn，有时候 cdn 返回会出问题,拿到就是代码问题了,看环境看代码,慢慢查,我们上次遇到全部正常返回,查了半天查不到原因,最后一抖机灵,发现部分 cdn 节点返回的文件 content 是 0,他娘的坑死了

一般白屏 都是网络问题导致 静态资源加载失败

我：先检查服务端和 f12 看看资源请求有没有问题。面试官：是用户反馈在他手机上白屏，你怎么 f12 呢。我：只有他手机上白屏的话....。 面试官：你怎么确定只有他手机白屏。 我：询问他的机型，去复现一下。 面试官：假如你这边打开都没有问题呢。我：。。。。。

复现不了 只能靠埋点了吧

这种问题还是很看思路的,别人有问题,一般不是你写的代码的问题,一般是别人的环境的问题

还是要看环境,我觉得这个问题贼棘手,网络环境 系统环境 浏览器环境,还有客户端版本,系统版本包含在系统环境了

面试官的意思是 无论怎么样你都复现不了 怎么办把

当时我是面美团的时候，三面的老板问的这个问题,当时面试官说的是，这个问题不是要你回答出标准答案的，是看你思考这个问题的思路的

**面试官问，你怎么在你本地定位到远程的某个用户页面出了问题，查日志怎么查**,我直接懵了啊，我分析了很多，他都说你都没根本性的解决问题,我说了埋点的方式，他说那你这个是一种比较通用的解决方式，所有用户都适用的。但是我要的是只解决那某个用户的问题

## 强缓存问题

::: tip Q
如果 test.js 的缓存是 1 天，但半天内，开发上线了新 js，这时候浏览器一直访问的是强缓存，那如何让浏览器拉取新的 js？
:::

已经强缓存了，就是在强缓存阶段或者它之前就让浏览器刷新

network 勾选 disable cache

f5 带那个 cache-control:max-age=0

ctrl+f5 是 pragma: no-cache 加 cache-control:no-cache

但是很诡异的还记得 private 是让中间服务器不缓存

- private： 这种情况就是只有浏览器能缓存了，中间的代理服务器不能缓存。
- no-cache: 跳过当前的强缓存，发送 HTTP 请求，即直接进入协商缓存阶段。
- no-store：非常粗暴，不进行任何形式的缓存。
- s-maxage：这和 max-age 长得比较像，但是区别在于 s-maxage 是针对代理服务器的缓存时间。

我用 edge 试了一下就是带的 no-cache，chrome 不知道为什么完全没有缓存

## 关于 vite 使用的打包工具

Vite 是 Vue 框架的作者尤雨溪最新推出的基于 Native-ESM 的 Web 构建工具。它在开发环境下基于 Native-ESM 处理构建过程，只编译不打包，在生产环境下则基于 Rollup 打包

- 多框架：除了在默认的 Vue 中使用外，还支持在 React 和 Preact 项目中使用。工具默认提供了 Vue、React 和 Preact 对应的脚手架模板
- 热更新（HMR）：默认提供的 3 种框架的脚手架模板中都内置了 HMR 功能，同时也提供了 HMR 的 API 供第三方插件或项目代码使用。
- 自定义配置文件：支持使用自定义配置文件来细化构建配置
- HTTPS 与 HTTP/2：支持使用 --https 启动参数来开启使用 HTTPS 和 HTTP/2 协议的开发服务器
- 服务代理：在自定义配置中支持配置代理，将部分请求代理到第三方服务
- 模式与环境变量：支持通过 mode 来指定构建模式为 development 或 production。相应模式下自动读取 dotenv 类型的环境变量配置文件，例如 .env.production.local
- 生产环境打包：生产环境使用 Rollup 进行打包，支持传入自定义配置

Vite 的使用限制如下

- 面向支持 ES6 的现代浏览器，在生产环境下，编译目标参数 esBuildTarget 的默认值为 es2019，最低支持版本为 es2015（因为内部会使用 esbuild 处理编译压缩，用来获得最快的构建速度）

::: tip 为什么不使用 esbuild 打包
虽然 esbuild 快的惊人，并且已经是一个在构建库方面比较出色的工具，但针对一些构建应用的重要功能仍然还在持续开发中---特别是代码分割和 css 处理方面，就目前来说，Rollup 在应用打包方面更加成熟和灵活，尽管如此，当未来这些功能稳定后，我们也不排除使用 esbuild 作为生产构建器的可能
:::

## react 中有数据绑定？？？

表单的双向绑定，说到底不过是 （value 的单向绑定 + onChange 事件侦听）的一个语法糖，你如果不想用 v-model，像 React 那样处理也是完全可以的。另一方面，组件间的数据传递，Vue 默认是单向的，和 React 一样

在 React 应用中，当某个组件的状态发生变化时，它会以该组件为根，重新渲染整个组件子树。当然，这可以通过 shouldComponentUpdate 这个生命周期方法来进行控制 purerender，但 Vue 将此视为默认的优化

vue 中实现数据绑定靠的是数据劫持（Object.defineProperty()）+发布-订阅模式。在 Vue 应用中，组件的依赖是在渲染过程中自动追踪的，所以系统能精确知晓哪个组件需要被重渲染。你可以理解为每一个组件都已经自动获得了 shouldComponentUpdate，并且没有上述的子树问题限制

视图更新流程

React:

![](../../.vuepress/public/img/react.jpg)

Vue:

![](../../.vuepress/public/img/vue.jpg)

vue 中的数据双向绑定

```js
<input  v-model="userName" />
<input v-bind:value="userName" v-on:input="userName = $event.target.value" />
```

react 中数据双向绑定

```js
<input value={this.state.username} onchange={this.handleIputChange}>
```
